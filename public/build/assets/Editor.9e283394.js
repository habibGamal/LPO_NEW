import{f as j}from"./faCaretRight.0704a143.js";import{j as c,F as V,a,b as R,r as C,a2 as T,a0 as U,d as D}from"./app.f827bd24.js";import{F as l}from"./index.e2edf124.js";import{I as g}from"./index.0314e3f8.js";import{B as I}from"./button.76e5a0fb.js";import{U as A}from"./index.954c0332.js";import{P as E}from"./PlusOutlined.1af1335f.js";import{B as M}from"./Book.7d109b31.js";import"./index.953a42eb.js";import"./index.abe775bb.js";import"./type.728015f4.js";import"./pickAttrs.8f7876d6.js";import"./useForceUpdate.b3d2bfb0.js";import"./DeleteOutlined.ed83fdb3.js";import"./progress.90f3934e.js";import"./CheckOutlined.e49f391b.js";(function(e){Object.defineProperty(e,"__esModule",{value:!0});var s="fas",r="caret-right",n=256,m=512,p=[],u="f0da",f="M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z";e.definition={prefix:s,iconName:r,icon:[n,m,p,u,f]},e.faCaretRight=e.definition,e.prefix=s,e.iconName=r,e.width=n,e.height=m,e.ligatures=p,e.unicode=u,e.svgPathData=f,e.aliases=p})(j);function z({id:e,count:s,removeVideo:r,video:n=null}){return console.log(e),c(V,{children:[a("hr",{}),c("h4",{className:"text-lg font-sans text-center my-4",children:["Video No ",s+1]}),a(l.Item,{label:"Video Name",name:`video_name[${e}]`,initialValue:n==null?void 0:n.name,children:a(g,{})}),a(l.Item,{label:"Video Link",name:`video_link[${e}]`,initialValue:n==null?void 0:n.link,children:a(g,{})}),a(l.Item,{wrapperCol:{offset:16,span:20},children:a(I,{onClick:m=>r(m,e),type:"link",danger:!0,children:"- Remove Video"})}),a("hr",{})]})}function $({book:e=null}){var F,y,w,B,S,P;const[s]=l.useForm(),{errors:r}=R().props,[n,m]=C.exports.useState((e==null?void 0:e.videos.map((t,i)=>i))||[]),[p,u]=C.exports.useState(e?e.videos.length-1:-1),f=t=>{t.preventDefault(),m(i=>[...i,p+1]),u(i=>i+1)},x=(t,i)=>{t.preventDefault(),m(h=>h.filter(v=>v!==i))},[o,N]=C.exports.useState(e?[{uid:"-1",name:e.coverName,status:"done",url:e.cover}]:[]),L={beforeUpload:t=>!1,maxCount:1,fileList:o,onChange:({fileList:t})=>{N(t)}},_=t=>{var i;D.Inertia.post("/books",{...t,cover:(i=o==null?void 0:o[0])==null?void 0:i.originFileObj},{errorBag:"-1",preserveScroll:!0,onSuccess:()=>{s.resetFields(),N([]),m([])}})},O=t=>{var v;const i={...t,_method:"put"},h=(v=o[0])==null?void 0:v.uid;h&&h!=="-1"&&(i.cover=o[0].originFileObj),D.Inertia.post(`/books/${e.id}`,i,{forceFormData:!0,errorBag:`${e.id}`,preserveScroll:!0})},d=()=>e?r==null?void 0:r[`${e.id}`]:r==null?void 0:r["-1"];return a(V,{children:c("div",{className:"rounded bg-gray-100 shadow-sm p-4",children:[a(T,{icon:j.faCaretRight})," ",e?e.name:"Add New Book",c(l,{form:s,name:"basic",className:"max-w-[500px] mx-auto",labelCol:{span:6},wrapperCol:{span:16},initialValues:{remember:!0},onFinish:e?O:_,autoComplete:"off",method:"post",encType:"multipart/form-data",children:[a(l.Item,{label:"Book Name",name:"name",initialValue:e==null?void 0:e.name,validateStatus:((F=d())==null?void 0:F.name)&&"error",help:(y=d())==null?void 0:y.name,children:a(g,{})}),a(l.Item,{label:"Cover",name:"cover",valuePropName:"fileList",validateStatus:((w=d())==null?void 0:w.cover)&&"error",help:(B=d())==null?void 0:B.cover,children:a(V,{children:a(A,{...L,listType:"picture-card",children:c("div",{children:[a(E,{}),a("div",{style:{marginTop:8},children:"Upload"})]})})})}),a(l.Item,{name:"pdf",label:"PDF Link",initialValue:e==null?void 0:e.pdf,validateStatus:((S=d())==null?void 0:S.pdf)&&"error",help:(P=d())==null?void 0:P.pdf,children:a(g,{})}),n.map((t,i)=>a(z,{id:t,video:e?e.videos[t]:null,count:i,removeVideo:x},t)),a(l.Item,{wrapperCol:{offset:16,span:20},children:a(I,{onClick:t=>f(t),type:"link",children:"+ Add Video"})}),a(l.Item,{wrapperCol:{offset:10,span:16},children:a(I,{type:"primary",htmlType:"submit",children:"Save"})})]}),e&&a(U,{href:`/books/${e.id}`,method:"delete",as:"button",className:"ant-btn ant-btn-link ant-btn-dangerous",children:"Delete"})]})})}function ie({booksDB:e}){const s=e.map(r=>new M(r));return c("div",{className:"container my-16 flex flex-col gap-4",children:[a($,{}),s.map(r=>a($,{book:r},r.id))]})}export{ie as default};
