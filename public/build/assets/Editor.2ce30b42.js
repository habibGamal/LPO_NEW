import{j as p,F as v,a as t,b as U,r as h,a2 as _,a5 as A,a0 as O,d as B}from"./app.e4f2789c.js";import{F as i}from"./index.72579553.js";import{I as f}from"./index.bc32fdee.js";import{B as g}from"./button.61439e54.js";import{U as E}from"./index.696fa735.js";import{P as R}from"./PlusOutlined.f8271279.js";import{B as q}from"./Book.7d109b31.js";import"./index.04c07eb0.js";import"./index.77b1f0f9.js";import"./type.473f2bfa.js";import"./pickAttrs.34476f1e.js";import"./useForceUpdate.01ce4644.js";import"./DeleteOutlined.dcf6b973.js";import"./progress.c9fe7203.js";import"./CheckOutlined.d44d5d56.js";function z({id:e,count:s,removeVideo:n,video:l=null}){return console.log(e),p(v,{children:[t("hr",{}),p("h4",{className:"text-lg font-sans text-center my-4",children:["Video No ",s+1]}),t(i.Item,{label:"Video Name",name:`video_name[${e}]`,initialValue:l==null?void 0:l.name,children:t(f,{})}),t(i.Item,{label:"Video Link",name:`video_link[${e}]`,initialValue:l==null?void 0:l.link,children:t(f,{})}),t(i.Item,{wrapperCol:{offset:16,span:20},children:t(g,{onClick:d=>n(d,e),type:"link",danger:!0,children:"- Remove Video"})}),t("hr",{})]})}function S({book:e=null}){var x,C,I,F,y,N;const[s]=i.useForm(),{errors:n}=U().props,[l,d]=h.exports.useState((e==null?void 0:e.videos.map((a,r)=>r))||[]),[w,$]=h.exports.useState(e?e.videos.length-1:-1),L=a=>{a.preventDefault(),d(r=>[...r,w+1]),$(r=>r+1)},j=(a,r)=>{a.preventDefault(),d(c=>c.filter(u=>u!==r))},[o,V]=h.exports.useState(e?[{uid:"-1",name:e.coverName,status:"done",url:e.cover}]:[]),D={beforeUpload:a=>!1,maxCount:1,fileList:o,onChange:({fileList:a})=>{V(a)}},P=a=>{var r;B.Inertia.post("/books",{...a,cover:(r=o==null?void 0:o[0])==null?void 0:r.originFileObj},{errorBag:"-1",preserveScroll:!0,onSuccess:()=>{s.resetFields(),V([]),d([])}})},T=a=>{var u;const r={...a,_method:"put"},c=(u=o[0])==null?void 0:u.uid;c&&c!=="-1"&&(r.cover=o[0].originFileObj),B.Inertia.post(`/books/${e.id}`,r,{forceFormData:!0,errorBag:`${e.id}`,preserveScroll:!0})},m=()=>e?n==null?void 0:n[`${e.id}`]:n==null?void 0:n["-1"];return t(v,{children:p("div",{className:"rounded bg-gray-100 shadow-sm p-4",children:[t(_,{icon:A})," ",e?e.name:"Add New Book",p(i,{form:s,name:"basic",className:"max-w-[500px] mx-auto",labelCol:{span:6},wrapperCol:{span:16},initialValues:{remember:!0},onFinish:e?T:P,autoComplete:"off",method:"post",encType:"multipart/form-data",children:[t(i.Item,{label:"Book Name",name:"name",initialValue:e==null?void 0:e.name,validateStatus:((x=m())==null?void 0:x.name)&&"error",help:(C=m())==null?void 0:C.name,children:t(f,{})}),t(i.Item,{label:"Cover",name:"cover",valuePropName:"fileList",validateStatus:((I=m())==null?void 0:I.cover)&&"error",help:(F=m())==null?void 0:F.cover,children:t(v,{children:t(E,{...D,listType:"picture-card",children:p("div",{children:[t(R,{}),t("div",{style:{marginTop:8},children:"Upload"})]})})})}),t(i.Item,{name:"pdf",label:"PDF Link",initialValue:e==null?void 0:e.pdf,validateStatus:((y=m())==null?void 0:y.pdf)&&"error",help:(N=m())==null?void 0:N.pdf,children:t(f,{})}),l.map((a,r)=>t(z,{id:a,video:e?e.videos[a]:null,count:r,removeVideo:j},a)),t(i.Item,{wrapperCol:{offset:16,span:20},children:t(g,{onClick:a=>L(a),type:"link",children:"+ Add Video"})}),t(i.Item,{wrapperCol:{offset:10,span:16},children:t(g,{type:"primary",htmlType:"submit",children:"Save"})})]}),e&&t(O,{href:`/books/${e.id}`,method:"delete",as:"button",className:"ant-btn ant-btn-link ant-btn-dangerous",children:"Delete"})]})})}function re({booksDB:e}){const s=e.map(n=>new q(n));return p("div",{className:"container my-16 flex flex-col gap-4",children:[t(S,{}),s.map(n=>t(S,{book:n},n.id))]})}export{re as default};
