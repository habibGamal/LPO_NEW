import{M as g}from"./Meeting.018e0e1b.js";import{b as B,r as f,a as e,F as b,j as l,a2 as j,d as y}from"./app.4b8763b9.js";import{h as R,D as q}from"./index.f9dc3d5f.js";import{I}from"./ImagesHandler.e7d6fa9d.js";import{F as r}from"./index.6eea52c1.js";import{I as c}from"./index.5c53fd3b.js";import{S as n}from"./index.51a6a4b1.js";import{U as H}from"./index.6557c58f.js";import{B as Y}from"./button.ef91b0dd.js";import{P as z}from"./index.4abc6549.js";import{m as _}from"./index.747a46d8.js";import{f as G}from"./faCaretRight.94301215.js";import{P as A}from"./PlusOutlined.933a1709.js";import{M as J}from"./MinusCircleOutlined.ce0e8aa8.js";import"./type.be6b4af0.js";import"./index.f52e8109.js";import"./index.f32ed8a0.js";import"./KeyCode.bb3c3291.js";import"./index.92e459fd.js";import"./pickAttrs.e5f7708a.js";import"./Overflow.0ef4e45d.js";import"./index.572afd88.js";import"./CheckOutlined.52146004.js";import"./useForceUpdate.e83711ed.js";import"./DeleteOutlined.375fb572.js";import"./progress.281ef7c9.js";import"./ActionButton.c170867d.js";function O({meeting:t=null}){var M,F,x,k,v,C,w,P,D,N;const[d]=r.useForm(),{errors:o}=B().props,[m,u]=f.exports.useState(t?I.getPathsAsUploadFiles(t.assets):[]),[L,S]=f.exports.useState([]);f.exports.useEffect(()=>{t&&(u(I.getPathsAsUploadFiles(t.assets)),S([]))},[t]);const T={beforeUpload:a=>!1,fileList:m,multiple:!0,onChange:({fileList:a})=>{u(a)},onRemove:a=>{S(i=>[...i,a.name])}},U=a=>{y.Inertia.post("/meetings",{...a,date:a!=null&&a.date?a.date.format("YYYY-MM-DD"):null,assets:m.map(i=>i.originFileObj)},{errorBag:"-1",preserveScroll:!0,forceFormData:!0,onSuccess:()=>{_.success("Meeting has been added succesfuly"),d.resetFields(),u([])}})},V=a=>{var p;const i={...a,assets:I.getNewUploadedFiles(m),date:(p=a==null?void 0:a.date)==null?void 0:p.format("YYYY-MM-DD"),removedAssets:L,_method:"put"};console.log(i),y.Inertia.post(`/meetings/${t.id}`,i,{forceFormData:!0,errorBag:`${t.id}`,preserveScroll:!0,onSuccess:()=>{_.success("Meeting updated succesfuly")}})},s=()=>t?o==null?void 0:o[`${t.id}`]:o==null?void 0:o["-1"];return e(b,{children:l("div",{className:"rounded bg-gray-100 shadow-sm p-4",children:[e(j,{icon:G.faCaretRight})," ",t?t.name:"Make a new meeting",l(r,{form:d,name:t?`edit_${t.id}`:"new",className:"max-w-[500px] mx-auto",labelCol:{span:6},wrapperCol:{span:16},initialValues:{remember:!0},onFinish:t?V:U,autoComplete:"off",method:"post",encType:"multipart/form-data",children:[e(r.Item,{label:"Meeting Name",name:"name",initialValue:t==null?void 0:t.name,validateStatus:((M=s())==null?void 0:M.name)&&"error",help:(F=s())==null?void 0:F.name,children:e(c,{})}),e(r.Item,{label:"Meeting Link",name:"meeting_link",initialValue:t==null?void 0:t.link,validateStatus:((x=s())==null?void 0:x.meeting_link)&&"error",help:(k=s())==null?void 0:k.meeting_link,children:e(c,{})}),e(r.Item,{label:"Meeting Date",name:"date",initialValue:t?R(t.date):"",validateStatus:((v=s())==null?void 0:v.date)&&"error",help:(C=s())==null?void 0:C.date,children:e(q,{})}),e(r.Item,{label:"Meeting State",name:"state",initialValue:t==null?void 0:t.state,validateStatus:((w=s())==null?void 0:w.state)&&"error",help:(P=s())==null?void 0:P.state,children:l(n,{placeholder:"Select state",children:[e(n.Option,{value:"not_started",children:"Not Started"}),e(n.Option,{value:"in_meeting",children:"In Meeting"}),e(n.Option,{value:"ended",children:"Ended"}),e(n.Option,{value:"offline",children:"Offline"})]})}),e(r.Item,{label:"Assets",name:"assets[]",valuePropName:"fileList",children:e(b,{children:e(H,{...T,listType:"picture-card",children:l("div",{children:[e(A,{}),e("div",{style:{marginTop:8},children:"Upload"})]})})})}),e(r.Item,{name:"playlist_id",label:"Youtube playlist id",validateStatus:((D=s())==null?void 0:D.playlist_id)&&"error",help:(N=s())==null?void 0:N.playlist_id,children:e(c,{})}),e(r.List,{name:"videos",initialValue:t==null?void 0:t.videos,children:(a,{add:i,remove:p},{errors:$})=>l(b,{children:[a.map((h,E)=>l(r.Item,{label:`Video no ${E+1}`,required:!0,children:[e(r.Item,{...h,validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Please input embed code here"}],noStyle:!0,children:e(c,{placeholder:"Embed code",style:{width:"80%"}})}),e(J,{className:"dynamic-delete-button mx-2",onClick:()=>p(h.name)})]},h.key)),l(r.Item,{wrapperCol:{offset:6,span:16},children:[e(Y,{type:"dashed",onClick:()=>i(),icon:e(A,{}),children:"Add video"}),e(r.ErrorList,{errors:$})]})]})}),e(r.Item,{wrapperCol:{offset:10,span:16},children:e(Y,{type:"primary",htmlType:"submit",children:"Save"})})]}),t&&e(z,{title:"Are you sure to delete this meeting?",onConfirm:()=>y.Inertia.delete(`/meetings/${t.id}`),okText:"Yes",cancelText:"No",children:e("span",{className:"ant-btn ant-btn-link ant-btn-dangerous",children:"Delete"})})]})})}function xe({meetingsDB:t}){const d=t.map(o=>new g(o));return l("div",{className:"container my-16 flex flex-col gap-4",children:[e(O,{}),d.map(o=>e(O,{meeting:o},o.id))]})}export{xe as default};
